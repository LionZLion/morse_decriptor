# Morse Neural Decoder

Проект предназначен для распознавания радиосообщений, переданных в коде Морзе в режиме реального времени, с помощью сверточной нейросети и CTC-декодера. Основная цель — разработать автоматизированную систему, способную переводить зашумлённые аудиосигналы в текст в реальном времени, используя временные спектральные представления и глубокое обучение.

## Цель проекта

- интерпретировать сигнал с шумом и искажениями,
- преобразовать его в частотное представление (STFT),
- декодировать в исходный текст.

Данный проект представляет из себя часть большего проекта для интерактивного учебника по цифровой обработке сигналов. В первую очередь модель предназачена для работы с синтетическими данными

## Основные идеи

В работе анализируется фурье спектр сигнала. Для уменьшение размерности и уменьшения времени обучения применяется метод short-time fourier transform. Для этого исходный сигнал анализируется оконным Фурье с шагом. Величина шага уменьшает в размер шага длину сигнала.

## Входные данные

Путь от строки до предсказания:
- **Произвольная строка** на русском языке с некоторыми специальными символами,
- **Код Морзе** выбранной строки с некоторыми параметрами,
- **Синтезированный аудиосигнал** с заданными параметрами частоты и длительности импульсов,
- **Шумовой фон**, имитирующий радиопомехи,
- Преобразованный сигнал в **одномерную спектрограмму STFT**, которая подаётся в модель.

## Структура проекта

```bash
.
├── morse_dataset/
│   ├── ...                    # Генерация синтетического датасета
├── stft.py                    # Функция расчёта STFT из 1D-сигнала
├── CTC_decoder.py             # CTC-декодер: argmax -> символы
├── neural.ipynb               # Основной ноутбук: обучение, визуализация, тестирование
├── README.md                  # Описание проекта
├── model_class.py             # Финальная архитектура нейронной сети
├── neural.py                  # Для использования в другом проекте
```

# Архитектура модели

Класс `Morse_Decoder` реализует сверточную нейросеть с LSTM и CTC-Loss. Основные компоненты:

## 1. Свёрточные блоки (3 блока)

Каждый блок содержит 64 скрытых слоя:
- `Conv1d()`
- `BatchNorm1d(64)` для нормализации.
- `Softplus()` - показал лучший результат.
- `Dropout()` для регуляризации.

## 2. LSTM

Добавление после свёрточных слоёв улучшает качество модели

## 3. Линейный классификатор

Полученное тензорное представление разворачивается и передаётся в линейный слой:
- `Linear(64*2, num_characters + 1)` — выходной размер равен числу символов плюс «blank» для CTC.

## 4. CTC Loss и декодирование

- Во время обучения используется `CTCLoss(blank=0)`.
- На этапе инференса применяется жадный декодер, реализованный в `CTC_decoder.py`, для преобразования логитов в последовательность символов.

## 5. Дополнительные детали

- Входной формат: STFT-спектрограмма размером `(1, 1, time_steps)`. Для этого выделяется основная частота в сигнале (Код Морзе передаётся с одной частотой). Поэтому двумерный сигнал с разными частотами на вход - избыточен.
- Использование пулинг слоёв приводит к размытию сигналов и уменьшению качества модели
- Обучение проводилось на сигналах разной длины с одним временем точки